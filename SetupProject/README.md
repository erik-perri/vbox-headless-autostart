# Setup Project

We use the [WiX Toolset](https://wixtoolset.org/) to build the installer and  [Paraffin](https://github.com/Wintellect/Paraffin/)
to build the product component based on the files in the publish directory.

* `Variables.wxi` contains the variables used in the installation file
* `Installer.wxi` contains the main Wix configuration
* `Product.wxs` contains the component generated by Paraffin

After updating `Product.wxs` the `LaunchFileKey` variable in `Variables.wxi` must be updated to match Paraffin's
generated value.

## Paraffin commands

#### Generating a new Product.wxs

In a command prompt from the SetupProject directory:

`Paraffin.exe -dir ..\TrayApp\bin\Release\netcoreapp3.1 -alias ..\TrayApp\bin\Release\netcoreapp3.1 -includeFile Installer.wxi -GroupName CG_VBoxHeadlessTrayApp -dirref INSTALLFOLDER -regExExclude "\.dev\.json$" -NoRootDirectory Product.wxs`

#### Updating the existing Product.wsx

In a command prompt from the SetupProject directory:

`Paraffin.exe -update Product.wxs`

That will produce `Product.PARAFFIN` which should replace `Product.wxs` after verifying the file was generated
correctly.